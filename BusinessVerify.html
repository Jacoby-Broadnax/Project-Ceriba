<html>
  <head>
    <meta name="language" content="English" />
    <title>Project Ceriba</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta charset="UTF-8" />
    <link
      rel="stylesheet"
      href="style_business_verification.css"
      type="text/css"
    />
    <link rel="stylesheet" href="style_header_nav" type="text/css" />
    <link rel="icon" href="favicon.ico" />
    <!--<script src="/delete_handler.js"></script>-->
     <script src="https://code.jquery.com/jquery-1.12.4.min.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/handlebars.js/4.0.12/handlebars.min.js"></script>
        <script src="https://code.jquery.com/jquery-3.4.1.min.js"
        integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
        <script>
          $(document).ready(function () { //this line is causing issuestry  if you want to see the issue go to business verification  
            $('#delete').submit(function (e) {
                e.preventDefault();
                let form = $(this);
                $.ajax({
                    type: 'delete',
                    dataType: 'json',
                    url: form.attr('action'),
                    data: {
                        ceriba: {
                            emtuar: $('#water').is(':checked'),
                            state: $('#state').val(),
                            business_city: $('#business_city').val(),
                            address: $('#address').val(),
                            phone: $('#business_contact_number').val(),
                            store: $('#business_name').val(),
                            jmsdeu: $('#meat').is(':checked'),
                            location: $('#business_city').val(),
                            timestamp: $('#timeS').val(),
                            jplqwnrt: $('#toilet').is(':checked'),
                            jzeurm: $('#mask').is(':checked'),
                            uxyzqio: $('#cleaning').is(':checked'),
                            poyunz: $('#chicken').is(':checked'), 
                        }
                    },
                    success: function () {
                        $('#success').show();
                        $('#post').hide();
                    },
                    error: function (xhr, res, text) {
                    console.log("An Error Occurred");
                
                    }
                });
            });
        });
          </script>
          Guess fixed now? looks like it, lets see if data disapears
    <script type="text/javascript">
//delete_handler.js:1 Uncaught ReferenceError: $ is not defined

function callit() {
        var link = "https://v2-api.sheety.co/1c0174d5b32dbebdf6f1e14d6ba67a4f/projectCeriba/ceriba";
          var idNum = document.getElementById("idsT").value;
          var actionlink = link + "/" + String(idNum);
             $.getJSON(actionlink, function (data) {
              var template = Handlebars.compile($('#item-template').html())
              $('#outputid').html(template(data.ceriba))
              alert(actionlink)
          })
      }
  </script>
  
  <script id="item-template" type="text/x-handlebars-template">
    <ul>
      
   <span id="id">{{id}}</span>
    <span id="store">{{store}}</span>
    <span id="phone">{{phone}}</span>
    <span id="timestamp">{{timestamp}}</span>
    <span id="datestamp">{{datestamp}}</span>
    <span id="state">{{state}}</span>
    <span id="city">{{city}}</span>
    <span id="address">{{address}}</span>
    <span id="emtuar">{{emtuar}}</span>
    <span id="jmsdeu">{{jmsdeu}}</span>
    <span id="jzeurm">{{jzeurm}}</span>
    <span id="uxyzqio">{{uxyzqio}}</span>
    <span id="jplqwnrt">{{jplqwnrt}}</span>
    <span id="poyunz">{{poyunz}}</span>
    </ul>
   </script>

  </head>

  <body>
    <div class="verification_wrap" id="verify">
      <h4>Verification</h4>
      <p>
        In order to post what items a business has in stock, we must verify you
        are a owner of a bussiness. Enter a associated business e-mail below.
      </p>
      <form action="BusinessForm.html">
        <input
          id="email_verify"
          type="email"
          placeholder="example@business.com"
          pattern="^[A-Za-z0-9_.]+[@](?!.*(gmail.com|yahoo.com|outlook.com|hotmail.com|[;\-&_'+,<>])).*(\.)[A-Za-z0-9_.]+$"
          required
        />
        <input id="verify_submit" type="submit" value="Submit" />
      </form>
    </div>

    <div class="verification_wrap" id="sorryID">
      <h4>Sorry! No can do</h4>
      <p>
        We detected that you already have a post made, if you would like to update your business stock, delete your previous post or wait until the next day.
      </p>

     
      
      <form  id="delete" onsubmit="bsCode()">
        <input id="qq" type="text" name="id" pattern="^[A-Za-z0-9]*$"  required/>
        <input id="ww" type="text" name="b_name" pattern="^[A-Za-z0-9]*$"  />
        <input id="ee" type="text" name="b_tel" pattern="^[A-Za-z0-9]*$"  />
        <input id="rr" type="text" name="timestamp" pattern="^[A-Za-z0-9 ]*$"  />
        <input id="tt" type="text" name="datestamp" pattern="^[A-Za-z0-9]*$" />
        <input id="yy" type="text"  name="b_state" pattern="^[A-Za-z0-9]*$"  />
        <input id="uu" type="text" name="b_city" pattern="^[A-Za-z0-9]*$"  />
        <input id="ii" type="text" name="water" pattern="^[A-Za-z0-9]*$"  />
        <input id="oo" type="text" name="meat" pattern="^[A-Za-z0-9]*$"  />
        <input id="pp" type="text" name="mask" pattern="^[A-Za-z0-9]*$"  />
        <input id="aa" type="text" name="toilet" pattern="^[A-Za-z0-9]*$"  />
        <input id="ss" type="text" name="cleaning" pattern="^[A-Za-z0-9]*$" />
        <input id="dd" type="text" name="chicken" pattern="^[A-Za-z0-9]*$" />
        <input id="ff" type="text" name="b_address" pattern="^[A-Za-z0-9]*$" />
      </form>

        <input id="idsT" type="text" name="id" pattern="^[0-9]*$"  required/>
        <button onclick="callit()">hsdfsdfi</button>
     
    </div>

    <div id="outputid"></div>

    <script>
      window.onload = function(){
        
        const observer = new MutationObserver(function
        (mutations){
            mutations.forEach(function(mutation){
                if (mutation.addedNodes.length){
                   isolateid();
                }

            })
        
        });
        const idsheet = document.getElementById("outputid");
        observer.observe(idsheet, {
            childList:true
        })

        var time = new Date();
          var n = time.getDay();
          if (window.localStorage["day"] == null){
              window.localStorage.setItem("day", n)
          }
          if (window.localStorage["day"] != n){
              window.localStorage.removeItem("ID")
              window.localStorage.setItem("day", n)
          }

      
      }

      function isolateid(){
          var q = document.getElementById("id").innerHTML
          var w = document.getElementById("store").innerHTML
          var e = document.getElementById("phone").innerHTML
          var r = document.getElementById("id").innerHTML
          var t = document.getElementById("datestamp").innerHTML
          var y = document.getElementById("state").innerHTML
          var u = document.getElementById("city").innerHTML
          var f = document.getElementById("address").innerHTML
          var i = document.getElementById("emtuar").innerHTML
          var o = document.getElementById("jmsdeu").innerHTML
          var p = document.getElementById("jzeurm").innerHTML
          var a = document.getElementById("uxyzqio").innerHTML
          var s = document.getElementById("jplqwnrt").innerHTML
          var d = document.getElementById("poyunz").innerHTML
          document.getElementById("qq").value = q
          document.getElementById("ww").value = w
          document.getElementById("ee").value = e
          document.getElementById("rr").value = r
          document.getElementById("tt").value = t
          document.getElementById("yy").value = y
          document.getElementById("uu").value = u
          document.getElementById("ii").value = i
          document.getElementById("oo").value = o
          document.getElementById("pp").value = p
          document.getElementById("aa").value = a
          document.getElementById("ss").value = s
          document.getElementById("dd").value = d
          document.getElementById("ff").value = f
          document.getElementById("delete").submit();

          
      }

      

        if (window.localStorage["ID"] == null || window.localStorage["ID"] == ""){
          document.getElementById("verify").style.display = "flex"
          document.getElementById("sorryID").style.display = "none"
  
        }
        else{
          document.getElementById("verify").style.display = "none"
          document.getElementById("sorryID").style.display = "flex"
       
        }

        function bsCode(){
          var link = "https://v2-api.sheety.co/1c0174d5b32dbebdf6f1e14d6ba67a4f/projectCeriba/ceriba";
          var idNum = document.getElementById("idsT").value;
          var actionlink = link + "/" + String(idNum);
          document.getElementById("delete").setAttribute("action", actionlink)
          window.location.replace("../BusinessVerify.html")
        }

    </script>


  </body>
</html>
